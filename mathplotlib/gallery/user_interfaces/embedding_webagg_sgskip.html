
<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />
<meta content="codex" name="keywords" />

    <title>Embedding WebAgg &#8212; Matplotlib 3.8.1 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/style.css?v=86e00652" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css?v=eafc0fe6" />
    <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css?v=7f9a90b1" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css?v=61a4c737" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
    <link rel="stylesheet" type="text/css" href="../../_static/mpl.css?v=a30b99b9" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script src="../../_static/documentation_options.js?v=52ef03d6"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=ccdb6887"></script>
    <script src="../../_static/design-tabs.js?v=36754332"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'gallery/user_interfaces/embedding_webagg_sgskip';</script>
    <script>
        DOCUMENTATION_OPTIONS.theme_switcher_json_url = 'https://matplotlib.org/devdocs/_static/switcher.json?3.8.1';
        DOCUMENTATION_OPTIONS.theme_switcher_version_match = 'stable';
        </script>
    <link rel="canonical" href="https://matplotlib.org/stable/gallery/user_interfaces/embedding_webagg_sgskip.html" />
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within Matplotlib 3.8.1 documentation"
          href="../../_static/opensearch.xml"/>
    <link rel="icon" href="../../_static/favicon.ico"/>
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Fourier Demo WX" href="fourier_demo_wx_sgskip.html" />
    <link rel="prev" title="Embedding in wx #5" href="embedding_in_wx5_sgskip.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  <div class="bd-header-announcement container-fluid" id="unreleased-message">
    <div class="bd-header-announcement__content">
      You are reading documentation for the unreleased version of Matplotlib.
      <a href="https://matplotlib.org/search.html?q=Embedding%20WebAgg&amp;check_keywords=yes&amp;area=default">
        Try searching for the released version of this page instead?
      </a>
    </div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  <div class="navbar-header-items__start">
    
      <div class="navbar-item">
   

<a class="navbar-brand logo" href="https://matplotlib.org/stable/">
  
  
  
  
    
    
      
    
    
    <img src="../../_static/logo_light.svg" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../../_static/logo_dark.svg" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
    
  </div>
  
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item"><ul id="navbar-main-elements" class="navbar-nav">
  <li class="nav-item">
    <a class="reference internal nav-link" href="../../plot_types/index.html">Plot types</a>
  </li>
  <li class="nav-item">
    <a class="reference internal nav-link" href="../../users/index.html">User guide</a>
  </li>
  <li class="nav-item">
    <a class="reference internal nav-link" href="../../tutorials/index.html">Tutorials</a>
  </li>
  <li class="nav-item">
    <a class="reference internal nav-link" href="../index.html">Examples</a>
  </li>
  <li class="nav-item">
    <a class="reference internal nav-link" href="../../api/index.html">Reference</a>
  </li>
  <li class="nav-item">
    <a class="reference internal nav-link" href="../../devel/index.html">Contribute</a>
  </li>
  <li class="nav-item">
    <a class="reference internal nav-link" href="../../users/release_notes.html">Releases</a>
  </li>
</ul></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
        </div>
      
      
        <div class="navbar-item">
<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script></div>
      
        <div class="navbar-item">
<script>
document.write(`
  <div class="version-switcher__container dropdown">
    <button type="button" class="version-switcher__button btn btn-sm navbar-btn dropdown-toggle" data-bs-toggle="dropdown">
      stable  <!-- this text may get changed later by javascript -->
      <span class="caret"></span>
    </button>
    <div class="version-switcher__menu dropdown-menu list-group-flush py-0">
    <!-- dropdown will be populated by javascript on page load -->
    </div>
  </div>
`);
</script></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://gitter.im/matplotlib/matplotlib" title="Gitter" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-gitter"></i></span>
            <label class="sr-only">Gitter</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://discourse.matplotlib.org" title="Discourse" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-discourse"></i></span>
            <label class="sr-only">Discourse</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/matplotlib/matplotlib" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-github"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://twitter.com/matplotlib/" title="Twitter" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-twitter"></i></span>
            <label class="sr-only">Twitter</label></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
    </div>
  

  
</div>

    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item"><ul id="navbar-main-elements" class="navbar-nav">
  <li class="nav-item">
    <a class="reference internal nav-link" href="../../plot_types/index.html">Plot types</a>
  </li>
  <li class="nav-item">
    <a class="reference internal nav-link" href="../../users/index.html">User guide</a>
  </li>
  <li class="nav-item">
    <a class="reference internal nav-link" href="../../tutorials/index.html">Tutorials</a>
  </li>
  <li class="nav-item">
    <a class="reference internal nav-link" href="../index.html">Examples</a>
  </li>
  <li class="nav-item">
    <a class="reference internal nav-link" href="../../api/index.html">Reference</a>
  </li>
  <li class="nav-item">
    <a class="reference internal nav-link" href="../../devel/index.html">Contribute</a>
  </li>
  <li class="nav-item">
    <a class="reference internal nav-link" href="../../users/release_notes.html">Releases</a>
  </li>
</ul></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">
<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script></div>
        
          <div class="navbar-item">
<script>
document.write(`
  <div class="version-switcher__container dropdown">
    <button type="button" class="version-switcher__button btn btn-sm navbar-btn dropdown-toggle" data-bs-toggle="dropdown">
      stable  <!-- this text may get changed later by javascript -->
      <span class="caret"></span>
    </button>
    <div class="version-switcher__menu dropdown-menu list-group-flush py-0">
    <!-- dropdown will be populated by javascript on page load -->
    </div>
  </div>
`);
</script></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://gitter.im/matplotlib/matplotlib" title="Gitter" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-gitter"></i></span>
            <label class="sr-only">Gitter</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://discourse.matplotlib.org" title="Discourse" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-discourse"></i></span>
            <label class="sr-only">Discourse</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/matplotlib/matplotlib" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-github"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://twitter.com/matplotlib/" title="Twitter" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-twitter"></i></span>
            <label class="sr-only">Twitter</label></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item"><nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../lines_bars_and_markers/index.html">Lines, bars and markers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../images_contours_and_fields/index.html">Images, contours and fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="../subplots_axes_and_figures/index.html">Subplots, axes and figures</a></li>
<li class="toctree-l1"><a class="reference internal" href="../statistics/index.html">Statistics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pie_and_polar_charts/index.html">Pie and polar charts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../text_labels_and_annotations/index.html">Text, labels and annotations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../color/index.html">Color</a></li>
<li class="toctree-l1"><a class="reference internal" href="../shapes_and_collections/index.html">Shapes and collections</a></li>
<li class="toctree-l1"><a class="reference internal" href="../style_sheets/index.html">Style sheets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pyplots/index.html">Module - pyplot</a></li>
<li class="toctree-l1"><a class="reference internal" href="../axes_grid1/index.html">Module - axes_grid1</a></li>
<li class="toctree-l1"><a class="reference internal" href="../axisartist/index.html">Module - axisartist</a></li>
<li class="toctree-l1"><a class="reference internal" href="../showcase/index.html">Showcase</a></li>
<li class="toctree-l1"><a class="reference internal" href="../animation/index.html">Animation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../event_handling/index.html">Event handling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../misc/index.html">Miscellaneous</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mplot3d/index.html">3D plotting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../scales/index.html">Scales</a></li>
<li class="toctree-l1"><a class="reference internal" href="../specialty_plots/index.html">Specialty plots</a></li>
<li class="toctree-l1"><a class="reference internal" href="../spines/index.html">Spines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ticks/index.html">Ticks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../units/index.html">Units</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="index.html">Embedding Matplotlib in graphical user interfaces</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="canvasagg.html">CanvasAgg demo</a></li>
<li class="toctree-l2"><a class="reference internal" href="embedding_in_gtk3_panzoom_sgskip.html">Embedding in GTK3 with a navigation toolbar</a></li>
<li class="toctree-l2"><a class="reference internal" href="embedding_in_gtk3_sgskip.html">Embedding in GTK3</a></li>
<li class="toctree-l2"><a class="reference internal" href="embedding_in_gtk4_panzoom_sgskip.html">Embedding in GTK4 with a navigation toolbar</a></li>
<li class="toctree-l2"><a class="reference internal" href="embedding_in_gtk4_sgskip.html">Embedding in GTK4</a></li>
<li class="toctree-l2"><a class="reference internal" href="embedding_in_qt_sgskip.html">Embedding in Qt</a></li>
<li class="toctree-l2"><a class="reference internal" href="embedding_in_tk_sgskip.html">Embedding in Tk</a></li>
<li class="toctree-l2"><a class="reference internal" href="embedding_in_wx2_sgskip.html">Embedding in wx #2</a></li>
<li class="toctree-l2"><a class="reference internal" href="embedding_in_wx3_sgskip.html">Embedding in wx #3</a></li>
<li class="toctree-l2"><a class="reference internal" href="embedding_in_wx4_sgskip.html">Embedding in wx #4</a></li>
<li class="toctree-l2"><a class="reference internal" href="embedding_in_wx5_sgskip.html">Embedding in wx #5</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Embedding WebAgg</a></li>
<li class="toctree-l2"><a class="reference internal" href="fourier_demo_wx_sgskip.html">Fourier Demo WX</a></li>
<li class="toctree-l2"><a class="reference internal" href="gtk3_spreadsheet_sgskip.html">GTK3 spreadsheet</a></li>
<li class="toctree-l2"><a class="reference internal" href="gtk4_spreadsheet_sgskip.html">GTK4 spreadsheet</a></li>
<li class="toctree-l2"><a class="reference internal" href="mathtext_wx_sgskip.html">Display mathtext in WX</a></li>
<li class="toctree-l2"><a class="reference internal" href="mpl_with_glade3_sgskip.html">Matplotlib with Glade 3</a></li>
<li class="toctree-l2"><a class="reference internal" href="mplcvd.html">mplcvd -- an example of figure hook</a></li>
<li class="toctree-l2"><a class="reference internal" href="pylab_with_gtk3_sgskip.html">pyplot with GTK3</a></li>
<li class="toctree-l2"><a class="reference internal" href="pylab_with_gtk4_sgskip.html">pyplot with GTK4</a></li>
<li class="toctree-l2"><a class="reference internal" href="svg_histogram_sgskip.html">SVG Histogram</a></li>
<li class="toctree-l2"><a class="reference internal" href="svg_tooltip_sgskip.html">SVG Tooltip</a></li>
<li class="toctree-l2"><a class="reference internal" href="toolmanager_sgskip.html">Tool Manager</a></li>
<li class="toctree-l2"><a class="reference internal" href="web_application_server_sgskip.html">Embedding in a web application server (Flask)</a></li>
<li class="toctree-l2"><a class="reference internal" href="wxcursor_demo_sgskip.html">Adding a cursor in WX</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../widgets/index.html">Widgets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../userdemo/index.html">Userdemo</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumbs">
  <ul class="bd-breadcrumbs" role="navigation" aria-label="Breadcrumb">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../index.html" class="nav-link">Examples</a></li>
    
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">Embedding Matplotlib in graphical user interfaces</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">Embedding WebAgg</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-gallery-user-interfaces-embedding-webagg-sgskip-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="embedding-webagg">
<span id="sphx-glr-gallery-user-interfaces-embedding-webagg-sgskip-py"></span><h1>Embedding WebAgg<a class="headerlink" href="#embedding-webagg" title="Link to this heading">#</a></h1>
<p>This example demonstrates how to embed Matplotlib WebAgg interactive plotting
in your own web application and framework.  It is not necessary to do all this
if you merely want to display a plot in a browser or use Matplotlib's built-in
Tornado-based server &quot;on the side&quot;.</p>
<p>The framework being used must support web sockets.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">argparse</span>
<span class="kn">import</span> <span class="nn">io</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">mimetypes</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <a href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="pathlib.Path" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Path</span></a>
<span class="kn">import</span> <span class="nn">signal</span>
<span class="kn">import</span> <span class="nn">socket</span>

<span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">tornado</span>
<span class="k">except</span> <span class="ne">ImportError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
    <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;This example requires tornado.&quot;</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">err</span>
<span class="kn">import</span> <span class="n">tornado</span><span class="o">.</span><span class="n">httpserver</span>
<span class="kn">import</span> <span class="nn">tornado.ioloop</span>
<span class="kn">import</span> <span class="nn">tornado.web</span>
<span class="kn">import</span> <span class="nn">tornado.websocket</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
<span class="kn">from</span> <span class="nn">matplotlib.backends.backend_webagg</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">FigureManagerWebAgg</span><span class="p">,</span> <span class="n">new_figure_manager_given_figure</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">matplotlib.figure</span> <span class="kn">import</span> <a href="../../api/figure_api.html#matplotlib.figure.Figure" title="matplotlib.figure.Figure" class="sphx-glr-backref-module-matplotlib-figure sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Figure</span></a>


<span class="k">def</span> <span class="nf">create_figure</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a simple example figure.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fig</span> <span class="o">=</span> <a href="../../api/figure_api.html#matplotlib.figure.Figure" title="matplotlib.figure.Figure" class="sphx-glr-backref-module-matplotlib-figure sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Figure</span></a><span class="p">()</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">()</span>
    <span class="n">t</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.arange.html#numpy.arange" title="numpy.arange" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">arange</span></a><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">)</span>
    <span class="n">s</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.sin.html#numpy.sin" title="numpy.sin" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-data"><span class="n">np</span><span class="o">.</span><span class="n">sin</span></a><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <a href="https://numpy.org/doc/stable/reference/constants.html#numpy.pi" title="numpy.pi" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-data"><span class="n">np</span><span class="o">.</span><span class="n">pi</span></a> <span class="o">*</span> <span class="n">t</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">fig</span>


<span class="c1"># The following is the content of the web page.  You would normally</span>
<span class="c1"># generate this using some sort of template facility in your web</span>
<span class="c1"># framework, but here we just use Python string formatting.</span>
<span class="n">html_content</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;&lt;!DOCTYPE html&gt;</span>
<span class="s2">&lt;html lang=&quot;en&quot;&gt;</span>
<span class="s2">  &lt;head&gt;</span>
<span class="s2">    &lt;!-- TODO: There should be a way to include all of the required javascript</span>
<span class="s2">               and CSS so matplotlib can add to the set in the future if it</span>
<span class="s2">               needs to. --&gt;</span>
<span class="s2">    &lt;link rel=&quot;stylesheet&quot; href=&quot;_static/css/page.css&quot; type=&quot;text/css&quot;&gt;</span>
<span class="s2">    &lt;link rel=&quot;stylesheet&quot; href=&quot;_static/css/boilerplate.css&quot; type=&quot;text/css&quot;&gt;</span>
<span class="s2">    &lt;link rel=&quot;stylesheet&quot; href=&quot;_static/css/fbm.css&quot; type=&quot;text/css&quot;&gt;</span>
<span class="s2">    &lt;link rel=&quot;stylesheet&quot; href=&quot;_static/css/mpl.css&quot; type=&quot;text/css&quot;&gt;</span>
<span class="s2">    &lt;script src=&quot;mpl.js&quot;&gt;&lt;/script&gt;</span>

<span class="s2">    &lt;script&gt;</span>
<span class="s2">      /* This is a callback that is called when the user saves</span>
<span class="s2">         (downloads) a file.  Its purpose is really to map from a</span>
<span class="s2">         figure and file format to a url in the application. */</span>
<span class="s2">      function ondownload(figure, format) {</span>
<span class="s2">        window.open(&#39;download.&#39; + format, &#39;_blank&#39;);</span>
<span class="s2">      };</span>

<span class="s2">      function ready(fn) {</span>
<span class="s2">        if (document.readyState != &quot;loading&quot;) {</span>
<span class="s2">          fn();</span>
<span class="s2">        } else {</span>
<span class="s2">          document.addEventListener(&quot;DOMContentLoaded&quot;, fn);</span>
<span class="s2">        }</span>
<span class="s2">      }</span>

<span class="s2">      ready(</span>
<span class="s2">        function() {</span>
<span class="s2">          /* It is up to the application to provide a websocket that the figure</span>
<span class="s2">             will use to communicate to the server.  This websocket object can</span>
<span class="s2">             also be a &quot;fake&quot; websocket that underneath multiplexes messages</span>
<span class="s2">             from multiple figures, if necessary. */</span>
<span class="s2">          var websocket_type = mpl.get_websocket_type();</span>
<span class="s2">          var websocket = new websocket_type(&quot;</span><span class="si">%(ws_uri)s</span><span class="s2">ws&quot;);</span>

<span class="s2">          // mpl.figure creates a new figure on the webpage.</span>
<span class="s2">          var fig = new mpl.figure(</span>
<span class="s2">              // A unique numeric identifier for the figure</span>
<span class="s2">              </span><span class="si">%(fig_id)s</span><span class="s2">,</span>
<span class="s2">              // A websocket object (or something that behaves like one)</span>
<span class="s2">              websocket,</span>
<span class="s2">              // A function called when a file type is selected for download</span>
<span class="s2">              ondownload,</span>
<span class="s2">              // The HTML element in which to place the figure</span>
<span class="s2">              document.getElementById(&quot;figure&quot;));</span>
<span class="s2">        }</span>
<span class="s2">      );</span>
<span class="s2">    &lt;/script&gt;</span>

<span class="s2">    &lt;title&gt;matplotlib&lt;/title&gt;</span>
<span class="s2">  &lt;/head&gt;</span>

<span class="s2">  &lt;body&gt;</span>
<span class="s2">    &lt;div id=&quot;figure&quot;&gt;</span>
<span class="s2">    &lt;/div&gt;</span>
<span class="s2">  &lt;/body&gt;</span>
<span class="s2">&lt;/html&gt;</span>
<span class="s2">&quot;&quot;&quot;</span>


<span class="k">class</span> <span class="nc">MyApplication</span><span class="p">(</span><a href="https://www.tornadoweb.org/en/stable/web.html#tornado.web.Application" title="tornado.web.Application" class="sphx-glr-backref-module-tornado-web sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">tornado</span><span class="o">.</span><span class="n">web</span><span class="o">.</span><span class="n">Application</span></a><span class="p">):</span>
    <span class="k">class</span> <span class="nc">MainPage</span><span class="p">(</span><a href="https://www.tornadoweb.org/en/stable/web.html#tornado.web.RequestHandler" title="tornado.web.RequestHandler" class="sphx-glr-backref-module-tornado-web sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">tornado</span><span class="o">.</span><span class="n">web</span><span class="o">.</span><span class="n">RequestHandler</span></a><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Serves the main HTML page.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="n">manager</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">application</span><span class="o">.</span><span class="n">manager</span>
            <span class="n">ws_uri</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;ws://</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">host</span><span class="si">}</span><span class="s2">/&quot;</span>
            <span class="n">content</span> <span class="o">=</span> <span class="n">html_content</span> <span class="o">%</span> <span class="p">{</span>
                <span class="s2">&quot;ws_uri&quot;</span><span class="p">:</span> <span class="n">ws_uri</span><span class="p">,</span> <span class="s2">&quot;fig_id&quot;</span><span class="p">:</span> <span class="n">manager</span><span class="o">.</span><span class="n">num</span><span class="p">}</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">content</span><span class="p">)</span>

    <span class="k">class</span> <span class="nc">MplJs</span><span class="p">(</span><a href="https://www.tornadoweb.org/en/stable/web.html#tornado.web.RequestHandler" title="tornado.web.RequestHandler" class="sphx-glr-backref-module-tornado-web sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">tornado</span><span class="o">.</span><span class="n">web</span><span class="o">.</span><span class="n">RequestHandler</span></a><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Serves the generated matplotlib javascript file.  The content</span>
<span class="sd">        is dynamically generated based on which toolbar functions the</span>
<span class="sd">        user has defined.  Call `FigureManagerWebAgg` to get its</span>
<span class="sd">        content.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_header</span><span class="p">(</span><span class="s1">&#39;Content-Type&#39;</span><span class="p">,</span> <span class="s1">&#39;application/javascript&#39;</span><span class="p">)</span>
            <span class="n">js_content</span> <span class="o">=</span> <span class="n">FigureManagerWebAgg</span><span class="o">.</span><span class="n">get_javascript</span><span class="p">()</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">js_content</span><span class="p">)</span>

    <span class="k">class</span> <span class="nc">Download</span><span class="p">(</span><a href="https://www.tornadoweb.org/en/stable/web.html#tornado.web.RequestHandler" title="tornado.web.RequestHandler" class="sphx-glr-backref-module-tornado-web sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">tornado</span><span class="o">.</span><span class="n">web</span><span class="o">.</span><span class="n">RequestHandler</span></a><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handles downloading of the figure in various file formats.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fmt</span><span class="p">):</span>
            <span class="n">manager</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">application</span><span class="o">.</span><span class="n">manager</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_header</span><span class="p">(</span>
                <span class="s1">&#39;Content-Type&#39;</span><span class="p">,</span> <span class="n">mimetypes</span><span class="o">.</span><span class="n">types_map</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">fmt</span><span class="p">,</span> <span class="s1">&#39;binary&#39;</span><span class="p">))</span>
            <span class="n">buff</span> <span class="o">=</span> <a href="https://docs.python.org/3/library/io.html#io.BytesIO" title="io.BytesIO" class="sphx-glr-backref-module-io sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span></a><span class="p">()</span>
            <span class="n">manager</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">buff</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="n">fmt</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">buff</span><span class="o">.</span><span class="n">getvalue</span><span class="p">())</span>

    <span class="k">class</span> <span class="nc">WebSocket</span><span class="p">(</span><a href="https://www.tornadoweb.org/en/stable/websocket.html#tornado.websocket.WebSocketHandler" title="tornado.websocket.WebSocketHandler" class="sphx-glr-backref-module-tornado-websocket sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">tornado</span><span class="o">.</span><span class="n">websocket</span><span class="o">.</span><span class="n">WebSocketHandler</span></a><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A websocket for interactive communication between the plot in</span>
<span class="sd">        the browser and the server.</span>

<span class="sd">        In addition to the methods required by tornado, it is required to</span>
<span class="sd">        have two callback methods:</span>

<span class="sd">            - ``send_json(json_content)`` is called by matplotlib when</span>
<span class="sd">              it needs to send json to the browser.  `json_content` is</span>
<span class="sd">              a JSON tree (Python dictionary), and it is the responsibility</span>
<span class="sd">              of this implementation to encode it as a string to send over</span>
<span class="sd">              the socket.</span>

<span class="sd">            - ``send_binary(blob)`` is called to send binary image data</span>
<span class="sd">              to the browser.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">supports_binary</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">def</span> <span class="nf">open</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="c1"># Register the websocket with the FigureManager.</span>
            <span class="n">manager</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">application</span><span class="o">.</span><span class="n">manager</span>
            <span class="n">manager</span><span class="o">.</span><span class="n">add_web_socket</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;set_nodelay&#39;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_nodelay</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">on_close</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="c1"># When the socket is closed, deregister the websocket with</span>
            <span class="c1"># the FigureManager.</span>
            <span class="n">manager</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">application</span><span class="o">.</span><span class="n">manager</span>
            <span class="n">manager</span><span class="o">.</span><span class="n">remove_web_socket</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">on_message</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">):</span>
            <span class="c1"># The &#39;supports_binary&#39; message is relevant to the</span>
            <span class="c1"># websocket itself.  The other messages get passed along</span>
            <span class="c1"># to matplotlib as-is.</span>

            <span class="c1"># Every message has a &quot;type&quot; and a &quot;figure_id&quot;.</span>
            <span class="n">message</span> <span class="o">=</span> <a href="https://docs.python.org/3/library/json.html#json.loads" title="json.loads" class="sphx-glr-backref-module-json sphx-glr-backref-type-py-function"><span class="n">json</span><span class="o">.</span><span class="n">loads</span></a><span class="p">(</span><span class="n">message</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">message</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;supports_binary&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">supports_binary</span> <span class="o">=</span> <span class="n">message</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">manager</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">application</span><span class="o">.</span><span class="n">manager</span>
                <span class="n">manager</span><span class="o">.</span><span class="n">handle_json</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">send_json</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">content</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">write_message</span><span class="p">(</span><a href="https://docs.python.org/3/library/json.html#json.dumps" title="json.dumps" class="sphx-glr-backref-module-json sphx-glr-backref-type-py-function"><span class="n">json</span><span class="o">.</span><span class="n">dumps</span></a><span class="p">(</span><span class="n">content</span><span class="p">))</span>

        <span class="k">def</span> <span class="nf">send_binary</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">blob</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">supports_binary</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">write_message</span><span class="p">(</span><span class="n">blob</span><span class="p">,</span> <span class="n">binary</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">data_uri</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;data:image/png;base64,&quot;</span> <span class="o">+</span>
                            <span class="n">blob</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;base64&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">write_message</span><span class="p">(</span><span class="n">data_uri</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">figure</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">figure</span> <span class="o">=</span> <span class="n">figure</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">manager</span> <span class="o">=</span> <span class="n">new_figure_manager_given_figure</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="n">figure</span><span class="p">),</span> <span class="n">figure</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">([</span>
            <span class="c1"># Static files for the CSS and JS</span>
            <span class="p">(</span><span class="sa">r</span><span class="s1">&#39;/_static/(.*)&#39;</span><span class="p">,</span>
             <a href="https://www.tornadoweb.org/en/stable/web.html#tornado.web.StaticFileHandler" title="tornado.web.StaticFileHandler" class="sphx-glr-backref-module-tornado-web sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">tornado</span><span class="o">.</span><span class="n">web</span><span class="o">.</span><span class="n">StaticFileHandler</span></a><span class="p">,</span>
             <span class="p">{</span><span class="s1">&#39;path&#39;</span><span class="p">:</span> <span class="n">FigureManagerWebAgg</span><span class="o">.</span><span class="n">get_static_file_path</span><span class="p">()}),</span>

            <span class="c1"># Static images for the toolbar</span>
            <span class="p">(</span><span class="sa">r</span><span class="s1">&#39;/_images/(.*)&#39;</span><span class="p">,</span>
             <a href="https://www.tornadoweb.org/en/stable/web.html#tornado.web.StaticFileHandler" title="tornado.web.StaticFileHandler" class="sphx-glr-backref-module-tornado-web sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">tornado</span><span class="o">.</span><span class="n">web</span><span class="o">.</span><span class="n">StaticFileHandler</span></a><span class="p">,</span>
             <span class="p">{</span><span class="s1">&#39;path&#39;</span><span class="p">:</span> <a href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="pathlib.Path" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">Path</span></a><span class="p">(</span><a href="../../api/matplotlib_configuration_api.html#matplotlib.get_data_path" title="matplotlib.get_data_path" class="sphx-glr-backref-module-matplotlib sphx-glr-backref-type-py-function"><span class="n">mpl</span><span class="o">.</span><span class="n">get_data_path</span></a><span class="p">(),</span> <span class="s1">&#39;images&#39;</span><span class="p">)}),</span>

            <span class="c1"># The page that contains all of the pieces</span>
            <span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">MainPage</span><span class="p">),</span>

            <span class="p">(</span><span class="s1">&#39;/mpl.js&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">MplJs</span><span class="p">),</span>

            <span class="c1"># Sends images and events to the browser, and receives</span>
            <span class="c1"># events from the browser</span>
            <span class="p">(</span><span class="s1">&#39;/ws&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">WebSocket</span><span class="p">),</span>

            <span class="c1"># Handles the downloading (i.e., saving) of static images</span>
            <span class="p">(</span><span class="sa">r</span><span class="s1">&#39;/download.([a-z0-9.]+)&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Download</span><span class="p">),</span>
        <span class="p">])</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">parser</span> <span class="o">=</span> <a href="https://docs.python.org/3/library/argparse.html#argparse.ArgumentParser" title="argparse.ArgumentParser" class="sphx-glr-backref-module-argparse sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span></a><span class="p">()</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-p&#39;</span><span class="p">,</span> <span class="s1">&#39;--port&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">8080</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Port to listen on (0 for a random port).&#39;</span><span class="p">)</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>

    <span class="n">figure</span> <span class="o">=</span> <span class="n">create_figure</span><span class="p">()</span>
    <span class="n">application</span> <span class="o">=</span> <span class="n">MyApplication</span><span class="p">(</span><span class="n">figure</span><span class="p">)</span>

    <span class="n">http_server</span> <span class="o">=</span> <a href="https://www.tornadoweb.org/en/stable/httpserver.html#tornado.httpserver.HTTPServer" title="tornado.httpserver.HTTPServer" class="sphx-glr-backref-module-tornado-httpserver sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">tornado</span><span class="o">.</span><span class="n">httpserver</span><span class="o">.</span><span class="n">HTTPServer</span></a><span class="p">(</span><span class="n">application</span><span class="p">)</span>
    <span class="n">sockets</span> <span class="o">=</span> <a href="https://www.tornadoweb.org/en/stable/netutil.html#tornado.netutil.bind_sockets" title="tornado.netutil.bind_sockets" class="sphx-glr-backref-module-tornado-netutil sphx-glr-backref-type-py-function"><span class="n">tornado</span><span class="o">.</span><span class="n">netutil</span><span class="o">.</span><span class="n">bind_sockets</span></a><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">port</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="n">http_server</span><span class="o">.</span><span class="n">add_sockets</span><span class="p">(</span><span class="n">sockets</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">sockets</span><span class="p">:</span>
        <span class="n">addr</span><span class="p">,</span> <span class="n">port</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">getsockname</span><span class="p">()[:</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">family</span> <span class="ow">is</span> <a href="https://docs.python.org/3/library/socket.html#socket.AF_INET6" title="socket.AF_INET6" class="sphx-glr-backref-module-socket sphx-glr-backref-type-py-data"><span class="n">socket</span><span class="o">.</span><span class="n">AF_INET6</span></a><span class="p">:</span>
            <span class="n">addr</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;[</span><span class="si">{</span><span class="n">addr</span><span class="si">}</span><span class="s1">]&#39;</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Listening on http://</span><span class="si">{</span><span class="n">addr</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">port</span><span class="si">}</span><span class="s2">/&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Press Ctrl+C to quit&quot;</span><span class="p">)</span>

    <span class="n">ioloop</span> <span class="o">=</span> <a href="https://www.tornadoweb.org/en/stable/ioloop.html#tornado.ioloop.IOLoop.instance" title="tornado.ioloop.IOLoop.instance" class="sphx-glr-backref-module-tornado-ioloop-IOLoop sphx-glr-backref-type-py-method"><span class="n">tornado</span><span class="o">.</span><span class="n">ioloop</span><span class="o">.</span><span class="n">IOLoop</span><span class="o">.</span><span class="n">instance</span></a><span class="p">()</span>

    <span class="k">def</span> <span class="nf">shutdown</span><span class="p">():</span>
        <span class="n">ioloop</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Server stopped&quot;</span><span class="p">)</span>

    <span class="n">old_handler</span> <span class="o">=</span> <a href="https://docs.python.org/3/library/signal.html#signal.signal" title="signal.signal" class="sphx-glr-backref-module-signal sphx-glr-backref-type-py-function"><span class="n">signal</span><span class="o">.</span><span class="n">signal</span></a><span class="p">(</span>
        <a href="https://docs.python.org/3/library/signal.html#signal.SIGINT" title="signal.SIGINT" class="sphx-glr-backref-module-signal sphx-glr-backref-type-py-data"><span class="n">signal</span><span class="o">.</span><span class="n">SIGINT</span></a><span class="p">,</span>
        <span class="k">lambda</span> <span class="n">sig</span><span class="p">,</span> <span class="n">frame</span><span class="p">:</span> <span class="n">ioloop</span><span class="o">.</span><span class="n">add_callback_from_signal</span><span class="p">(</span><span class="n">shutdown</span><span class="p">))</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">ioloop</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
    <span class="k">finally</span><span class="p">:</span>
        <a href="https://docs.python.org/3/library/signal.html#signal.signal" title="signal.signal" class="sphx-glr-backref-module-signal sphx-glr-backref-type-py-function"><span class="n">signal</span><span class="o">.</span><span class="n">signal</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/signal.html#signal.SIGINT" title="signal.SIGINT" class="sphx-glr-backref-module-signal sphx-glr-backref-type-py-data"><span class="n">signal</span><span class="o">.</span><span class="n">SIGINT</span></a><span class="p">,</span> <span class="n">old_handler</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-gallery-user-interfaces-embedding-webagg-sgskip-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/d558d74d36a57f66fc595a6bb564b180/embedding_webagg_sgskip.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">embedding_webagg_sgskip.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/b5cbdfa83b33e22687e6420da37101b9/embedding_webagg_sgskip.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">embedding_webagg_sgskip.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>


                </article>
              
              
              
            </div>
            
            
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">
  <p class="copyright">
    
      © Copyright 2002–2012 John Hunter, Darren Dale, Eric Firing, Michael Droettboom and the Matplotlib development team; 2012–2023 The Matplotlib development team.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">
  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.6.
    <br/>
  </p>
</div>
      
        <div class="footer-item">
  <p class="sphinx-version">
    Built from 3.8.1.
    <br/>
  </p>
</div>
      
    </div>
  
  
    <div class="footer-items__end">
      
        <div class="footer-item"><p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.13.3.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>